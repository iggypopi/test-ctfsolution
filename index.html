<!DOCTYPE html>
<html>
<head>
    <title>Direct S3 Bucket Access</title>
</head>
<body>
    <h1>🪣 Direct S3 Bucket Access Test</h1>
    <div id="results"></div>
    
    <script>
        var results = "";
        
        // Try to access S3 buckets directly (some might be public)
        results += "<h2>🎯 Direct S3 Bucket Enumeration</h2>";
        results += "<p>Based on original writeup: S3 bucket 'secretdocs' with 'leviathan.txt'</p>";
        
        var s3Tests = [
            // Original writeup S3 bucket
            { url: 'https://secretdocs.s3.amazonaws.com/', desc: 'secretdocs bucket (original writeup)' },
            { url: 'https://secretdocs.s3.amazonaws.com/leviathan.txt', desc: 'leviathan.txt (original flag file)' },
            { url: 'http://secretdocs.s3.amazonaws.com/', desc: 'secretdocs HTTP' },
            { url: 'http://secretdocs.s3.amazonaws.com/leviathan.txt', desc: 'leviathan.txt HTTP' },
            
            // Common S3 bucket names for CTFs
            { url: 'https://flag.s3.amazonaws.com/', desc: 'flag bucket' },
            { url: 'https://flags.s3.amazonaws.com/', desc: 'flags bucket' },
            { url: 'https://ctf.s3.amazonaws.com/', desc: 'ctf bucket' },
            { url: 'https://challenge.s3.amazonaws.com/', desc: 'challenge bucket' },
            { url: 'https://tenable.s3.amazonaws.com/', desc: 'tenable bucket' },
            { url: 'https://tenablecs.s3.amazonaws.com/', desc: 'tenablecs bucket' },
            { url: 'https://tenablecstools.s3.amazonaws.com/', desc: 'tenablecstools bucket' },
            { url: 'https://hacking-tools.s3.amazonaws.com/', desc: 'hacking-tools bucket' },
            { url: 'https://hackingtools.s3.amazonaws.com/', desc: 'hackingtools bucket' },
            
            // Try different file names
            { url: 'https://secretdocs.s3.amazonaws.com/flag.txt', desc: 'flag.txt in secretdocs' },
            { url: 'https://secretdocs.s3.amazonaws.com/flag', desc: 'flag in secretdocs' },
            { url: 'https://secretdocs.s3.amazonaws.com/secret.txt', desc: 'secret.txt in secretdocs' },
            
            // Different regions
            { url: 'https://secretdocs.s3.us-east-1.amazonaws.com/', desc: 'secretdocs us-east-1' },
            { url: 'https://secretdocs.s3.us-east-1.amazonaws.com/leviathan.txt', desc: 'leviathan.txt us-east-1' },
            { url: 'https://secretdocs.s3-us-east-1.amazonaws.com/', desc: 'secretdocs s3-us-east-1' },
            { url: 'https://secretdocs.s3-us-east-1.amazonaws.com/leviathan.txt', desc: 'leviathan.txt s3-us-east-1' },
        ];
        
        for(var i = 0; i < s3Tests.length; i++) {
            try {
                var test = s3Tests[i];
                results += "<h3>🪣 " + (i+1) + ": " + test.desc + "</h3>";
                results += "<div style='font-size:11px;color:#666;margin-bottom:5px;'>" + test.url + "</div>";
                
                var xhr = new XMLHttpRequest();
                xhr.open('GET', test.url, false);
                xhr.send();
                
                if(xhr.responseText && xhr.responseText.trim().length > 0) {
                    results += "<div style='background:#e8f5e8;padding:10px;border:2px solid green;'>✅ ACCESSIBLE: " + xhr.responseText.length + " bytes</div>";
                    
                    // Check for flag content
                    var text = xhr.responseText.toLowerCase();
                    if(text.includes('flag{') || text.includes('ctf{') || text.includes('}')) {
                        results += "<div style='background:#ff0000;color:white;padding:20px;border:5px solid red;text-align:center;font-size:18px;'>🎉🎉🎉 FLAG FOUND! 🎉🎉🎉</div>";
                    }
                    if(text.includes('leviathan') || text.includes('secret') || text.includes('no sound, once made')) {
                        results += "<div style='background:#32cd32;color:white;padding:15px;border:3px solid green;'>🎯 ORIGINAL WRITEUP CONTENT DETECTED!</div>";
                    }
                    if(text.includes('<listbucketresult') || text.includes('<contents>')) {
                        results += "<div style='background:#74c0fc;padding:10px;'>📂 S3 BUCKET LISTING!</div>";
                    }
                    if(text.includes('access denied') || text.includes('403')) {
                        results += "<div style='background:#ffcccb;padding:8px;'>🚫 Access Denied</div>";
                    }
                    if(text.includes('no such bucket') || text.includes('404')) {
                        results += "<div style='background:#ffeaa7;padding:8px;'>❌ Bucket Not Found</div>";
                    }
                    
                    results += "<div style='background:#f0f0f0;padding:10px;max-height:200px;overflow:scroll;font-size:10px;white-space:pre-wrap;word-wrap:break-word;'>" + xhr.responseText + "</div>";
                } else {
                    results += "<div style='background:#ffe8e8;padding:3px;'>❌ No response</div>";
                }
            } catch(e) {
                results += "<div style='background:#ffe8e8;padding:3px;'>❌ " + e.message.substring(0, 60) + "</div>";
            }
        }
        
        document.getElementById("results").innerHTML = results;
    </script>
</body>
</html>
